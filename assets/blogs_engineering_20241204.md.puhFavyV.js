import{_ as s,c as i,o as a,a7 as n}from"./chunks/framework.DLSH1pMh.js";const l="/assets/WinSCP%E6%96%B0%E5%BB%BA%E7%AB%99%E7%82%B9.Dfu9IPRL.jpg",h="/assets/%E4%B8%8A%E4%BC%A0%E5%89%8D%E7%AB%AFdist.BQJlq5Uf.jpg",y=JSON.parse('{"title":"部署方案详解","description":"","frontmatter":{"title":"部署方案详解","date":"2024-12-04T00:00:00.000Z","categories":["工程化"]},"headers":[],"relativePath":"blogs/engineering/20241204.md","filePath":"blogs/engineering/20241204.md"}'),p={name:"blogs/engineering/20241204.md"},t=n(`<h1 id="前端部署方案详解-🚀" tabindex="-1">前端部署方案详解 🚀 <a class="header-anchor" href="#前端部署方案详解-🚀" aria-label="Permalink to &quot;前端部署方案详解 🚀&quot;">​</a></h1><h2 id="一、认识-nginx-网站部署的守门员-🛡️" tabindex="-1">一、认识 Nginx - 网站部署的守门员 🛡️ <a class="header-anchor" href="#一、认识-nginx-网站部署的守门员-🛡️" aria-label="Permalink to &quot;一、认识 Nginx - 网站部署的守门员 🛡️&quot;">​</a></h2><h3 id="_1-nginx-是什么" tabindex="-1">1. Nginx 是什么？ <a class="header-anchor" href="#_1-nginx-是什么" aria-label="Permalink to &quot;1. Nginx 是什么？&quot;">​</a></h3><p>Nginx 就像是一个智能管家 🫅：</p><ul><li>📝 负责接待用户的访问请求</li><li>🗂️ 管理不同请求对应的文件位置</li><li>🚦 处理大量并发访问</li><li>🔒 提供安全防护</li><li>⚡ 优化网站性能</li></ul><h3 id="_2-nginx-的核心功能" tabindex="-1">2. Nginx 的核心功能 <a class="header-anchor" href="#_2-nginx-的核心功能" aria-label="Permalink to &quot;2. Nginx 的核心功能&quot;">​</a></h3><ul><li><strong>反向代理</strong>: 转发请求到后端服务器</li><li><strong>负载均衡</strong>: 分配流量到多个服务器</li><li><strong>静态资源服务</strong>: 高效处理静态文件</li><li><strong>缓存</strong>: 提升访问速度</li><li><strong>SSL/TLS</strong>: 支持 HTTPS 加密</li></ul><h3 id="_3-服务器目录结构" tabindex="-1">3. 服务器目录结构 <a class="header-anchor" href="#_3-服务器目录结构" aria-label="Permalink to &quot;3. 服务器目录结构&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> etc/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # 配置文件目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         # Nginx 配置目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx.conf</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # Nginx 主配置文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sites-available/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       # 网站配置文件存放目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> your-domain.conf</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # 你的网站配置(重点)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sites-enabled/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         # 已启用的配置文件（软链接）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> var/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> www/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">           # 网站文件目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> your-domain/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # 你的网站目录(重点)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> index.html</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> css/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> js/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> log/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Nginx 日志目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lib/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mysql/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # MySQL 数据库目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mongodb/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # MongoDB 数据库目录 </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">└──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> usr/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> share/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     # Nginx 默认文件目录</span></span></code></pre></div><h3 id="_4-实际案例-nginx-配置" tabindex="-1">4. 实际案例 Nginx 配置 <a class="header-anchor" href="#_4-实际案例-nginx-配置" aria-label="Permalink to &quot;4. 实际案例 Nginx 配置&quot;">​</a></h3><h4 id="_1-单页应用-spa-配置" tabindex="-1">1. 单页应用(SPA)配置 <a class="header-anchor" href="#_1-单页应用-spa-配置" aria-label="Permalink to &quot;1. 单页应用(SPA)配置&quot;">​</a></h4><div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    listen </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    server_name </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">spa.example.com;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    root </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/var/www/spa;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 支持 history 路由</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> / </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        try_files </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$uri $uri/ /index.html;   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 文件查找顺序</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 开启 gzip</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        gzip </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        gzip_types </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">text/plain application/javascript text/css;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 静态资源缓存</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> /assets/ </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        expires </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">1y;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        add_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Cache-Control </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;public, no-transform&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h4 id="_2-多应用部署配置" tabindex="-1">2. 多应用部署配置 <a class="header-anchor" href="#_2-多应用部署配置" aria-label="Permalink to &quot;2. 多应用部署配置&quot;">​</a></h4><div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 主应用</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    listen </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    server_name </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">example.com;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> / </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        root </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/var/www/main;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        index </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">index.html;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 后端API配置</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> /api </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{                   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 匹配所有 /api 开头的请求</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        proxy_pass </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">http://localhost:3000;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 转发到本地3000端口</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        proxy_http_version </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用HTTP 1.1协议</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        proxy_set_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Upgrade $http_upgrade;        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># WebSocket支持</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        proxy_set_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Connection </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;upgrade&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># WebSocket支持</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        proxy_set_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Host $host;                  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 传递原始主机名</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 子应用</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    listen </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    server_name </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">blog.example.com;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> / </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        root </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/var/www/blog;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        index </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">index.html;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="二、部署方案分类-📦" tabindex="-1">二、部署方案分类 📦 <a class="header-anchor" href="#二、部署方案分类-📦" aria-label="Permalink to &quot;二、部署方案分类 📦&quot;">​</a></h2><h3 id="_1-手动部署" tabindex="-1">1. 手动部署 <a class="header-anchor" href="#_1-手动部署" aria-label="Permalink to &quot;1. 手动部署&quot;">​</a></h3><p>适合小型项目或个人网站。</p><h4 id="winscp-可视化部署-🖥️" tabindex="-1">WinSCP 可视化部署 🖥️ <a class="header-anchor" href="#winscp-可视化部署-🖥️" aria-label="Permalink to &quot;WinSCP 可视化部署 🖥️&quot;">​</a></h4><p>对于前端工程师，如果没有 linux 的学习经验，对于命令行的使用，可能不太熟悉。所以这里首先介绍一个可视化的工具 WinSCP。</p><ol><li><p><strong>安装配置</strong><img src="`+l+`" alt="WinSCP新建站点"></p><ul><li>下载 <a href="https://winscp.net/eng/download.php" target="_blank" rel="noreferrer">WinSCP</a></li><li>选择 SFTP 协议（更安全）</li><li>配置服务器信息：<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>主机：服务器IP</span></span>
<span class="line"><span>端口：22</span></span>
<span class="line"><span>用户名：root/其他用户</span></span>
<span class="line"><span>密码：对应密码</span></span></code></pre></div></li></ul></li><li><p><strong>使用技巧</strong><img src="`+h+`" alt="上传前端dist"></p><ul><li>拖拽上传文件</li><li>右键编辑文件</li><li>保存多个站点配置</li><li>支持文件同步</li></ul></li><li><p><strong>nginx</strong></p><ul><li>配置对应的 domain 映射（domain.conf）</li><li>重启nginx</li></ul></li></ol><h3 id="_2-自动化部署-🤖" tabindex="-1">2. 自动化部署 🤖 <a class="header-anchor" href="#_2-自动化部署-🤖" aria-label="Permalink to &quot;2. 自动化部署 🤖&quot;">​</a></h3><p>适合团队协作的中大型项目。</p><h4 id="jenkins-部署" tabindex="-1">Jenkins 部署 <a class="header-anchor" href="#jenkins-部署" aria-label="Permalink to &quot;Jenkins 部署&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Jenkinsfile 示例</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pipeline</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    agent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> any</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    stages</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        stage(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&#39;Build&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            steps</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;npm install&#39;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;npm run build&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        stage(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&#39;Deploy&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            steps</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;rsync -avz dist/ user@server:/var/www/site/&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h4 id="github-actions-部署" tabindex="-1">GitHub Actions 部署 <a class="header-anchor" href="#github-actions-部署" aria-label="Permalink to &quot;GitHub Actions 部署&quot;">​</a></h4><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># .github/workflows/deploy.yml</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Deploy</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    branches</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ]</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">jobs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  deploy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    runs-on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ubuntu-latest</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    steps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">uses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">actions/checkout@v2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Deploy to liuhuakawaii.icu</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">easingthemes/ssh-deploy@main</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 使用的是一个现成的GitHub Action，用于SSH部署</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # SSH私钥，用于免密登录服务器</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          SSH_PRIVATE_KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\${{ secrets.SSH_PRIVATE_KEY }}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # rsync命令的参数</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # -a: 归档模式，保持文件属性</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # -v: 显示详细信息</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # -z: 压缩传输</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # -r: 递归复制目录</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # --delete: 删除目标目录中有而源目录中没有的文件</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          ARGS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;-avzr --delete&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # 源目录：你要部署的文件所在目录</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          SOURCE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;docs/.vitepress/dist&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # 服务器IP地址或域名</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          REMOTE_HOST</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\${{ secrets.SSH_HOST }}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # 服务器登录用户名</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          REMOTE_USER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\${{ secrets.SSH_USERNAME }}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # 服务器上的目标部署目录</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          TARGET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\${{ secrets.REMOTE_DIR }}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # 排除不需要传输的文件/目录</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          EXCLUDE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/dist/, /node_modules/&quot;</span></span></code></pre></div><p>确保在 GitHub 仓库的设置中，将 secrets.SSH_HOST、secrets.SSH_USERNAME 和 secrets.REMOTE_DIR 添加为 secrets。</p><p><strong>注意事项</strong> 路径一定要注意</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 组合1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SOURCE:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;docs/.vitepress/dist&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 无斜杠</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TARGET:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/var/www/enlightencode/dist&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 结果: /var/www/enlightencode/dist/dist/[文件]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 组合2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SOURCE:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;docs/.vitepress/dist/&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 有斜杠</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TARGET:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/var/www/enlightencode/dist&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 结果: /var/www/enlightencode/dist/[文件]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 组合3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SOURCE:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;docs/.vitepress/dist&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 无斜杠</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TARGET:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/var/www/enlightencode&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 结果: /var/www/enlightencode/dist/[文件]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 组合4</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SOURCE:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;docs/.vitepress/dist/&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 有斜杠</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TARGET:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/var/www/enlightencode&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 结果: /var/www/enlightencode/[文件]</span></span></code></pre></div><h2 id="vitepress-博客部署注意事项-📝" tabindex="-1">VitePress 博客部署注意事项 📝 <a class="header-anchor" href="#vitepress-博客部署注意事项-📝" aria-label="Permalink to &quot;VitePress 博客部署注意事项 📝&quot;">​</a></h2><h3 id="_1-nginx-路由配置" tabindex="-1">1. Nginx 路由配置 <a class="header-anchor" href="#_1-nginx-路由配置" aria-label="Permalink to &quot;1. Nginx 路由配置&quot;">​</a></h3><p>VitePress 本质上是生成多个 HTML 文件来存储博客内容。如果你的链接没有 <code>.html</code> 后缀，需要特别注意 Nginx 的 <code>try_files</code> 配置。</p><h4 id="基础配置示例" tabindex="-1">基础配置示例 <a class="header-anchor" href="#基础配置示例" aria-label="Permalink to &quot;基础配置示例&quot;">​</a></h4><div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> / </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    try_files </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$uri $uri.html $uri/ /index.html;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h4 id="配置解析" tabindex="-1">配置解析 <a class="header-anchor" href="#配置解析" aria-label="Permalink to &quot;配置解析&quot;">​</a></h4><p>查找顺序：</p><ol><li><code>$uri</code> - 精确匹配请求的 URI</li><li><code>$uri.html</code> - 添加 .html 后缀尝试匹配</li><li><code>$uri/</code> - 作为目录路径查找</li><li><code>/index.html</code> - 以上都不存在时返回首页</li></ol><h3 id="_2-使用场景-🎯" tabindex="-1">2. 使用场景 🎯 <a class="header-anchor" href="#_2-使用场景-🎯" aria-label="Permalink to &quot;2. 使用场景 🎯&quot;">​</a></h3><h4 id="静态博客部署" tabindex="-1">静态博客部署 <a class="header-anchor" href="#静态博客部署" aria-label="Permalink to &quot;静态博客部署&quot;">​</a></h4><ul><li><strong>访问方式</strong>：<code>/posts/hello</code> → <code>/posts/hello.html</code></li><li><strong>优势</strong>：更友好的 URL，无需显示 .html 后缀</li></ul><h4 id="混合应用部署" tabindex="-1">混合应用部署 <a class="header-anchor" href="#混合应用部署" aria-label="Permalink to &quot;混合应用部署&quot;">​</a></h4><ul><li><strong>静态页面</strong>：<code>/blog/post-1</code> → <code>blog/post-1.html</code></li><li><strong>SPA 路由</strong>：<code>/app/*</code> → 由前端路由处理</li></ul><h3 id="_3-配置选择指南-⚡" tabindex="-1">3. 配置选择指南 ⚡ <a class="header-anchor" href="#_3-配置选择指南-⚡" aria-label="Permalink to &quot;3. 配置选择指南 ⚡&quot;">​</a></h3><h4 id="需要-uri-html-的情况" tabindex="-1">需要 <code>$uri.html</code> 的情况： <a class="header-anchor" href="#需要-uri-html-的情况" aria-label="Permalink to &quot;需要 \`$uri.html\` 的情况：&quot;">​</a></h4><ul><li>使用 VitePress/VuePress 等静态站点生成器</li><li>混合部署静态页面和 SPA</li><li>需要访问独立的 .html 文件</li></ul><h4 id="纯-spa-应用配置" tabindex="-1">纯 SPA 应用配置： <a class="header-anchor" href="#纯-spa-应用配置" aria-label="Permalink to &quot;纯 SPA 应用配置：&quot;">​</a></h4><div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> / </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    try_files </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$uri $uri/ /index.html;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="_4-常见问题排查-🔍" tabindex="-1">4. 常见问题排查 🔍 <a class="header-anchor" href="#_4-常见问题排查-🔍" aria-label="Permalink to &quot;4. 常见问题排查 🔍&quot;">​</a></h3><ul><li><strong>404 错误</strong>：检查文件是否存在于正确路径</li><li><strong>路由不匹配</strong>：确认 Nginx 配置中的查找顺序</li><li><strong>静态资源加载失败</strong>：检查资源路径和权限设置</li></ul>`,49),k=[t];function e(r,d,g,E,o,F){return a(),i("div",null,k)}const u=s(p,[["render",e]]);export{y as __pageData,u as default};
