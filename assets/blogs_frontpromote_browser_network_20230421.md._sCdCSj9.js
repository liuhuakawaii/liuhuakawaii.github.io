import{_ as s,c as i,o as a,a7 as l}from"./chunks/framework.DLSH1pMh.js";const y=JSON.parse('{"title":"localStorageè¶…è¿‡5Mäº†æ€ä¹ˆåŠï¼Ÿ","description":"","frontmatter":{"title":"localStorageè¶…è¿‡5Mäº†æ€ä¹ˆåŠï¼Ÿ","date":"2023-04-21T00:00:00.000Z","categories":["æµè§ˆå™¨","é¢è¯•"]},"headers":[],"relativePath":"blogs/frontpromote/browser&network/20230421.md","filePath":"blogs/frontpromote/browser&network/20230421.md"}'),n={name:"blogs/frontpromote/browser&network/20230421.md"},h=l(`<h1 id="localstorage-å­˜å‚¨é™åˆ¶åŠè§£å†³æ–¹æ¡ˆ-ğŸ”" tabindex="-1">localStorage å­˜å‚¨é™åˆ¶åŠè§£å†³æ–¹æ¡ˆ ğŸ” <a class="header-anchor" href="#localstorage-å­˜å‚¨é™åˆ¶åŠè§£å†³æ–¹æ¡ˆ-ğŸ”" aria-label="Permalink to &quot;localStorage å­˜å‚¨é™åˆ¶åŠè§£å†³æ–¹æ¡ˆ ğŸ”&quot;">â€‹</a></h1><h2 id="é—®é¢˜èƒŒæ™¯" tabindex="-1">é—®é¢˜èƒŒæ™¯ <a class="header-anchor" href="#é—®é¢˜èƒŒæ™¯" aria-label="Permalink to &quot;é—®é¢˜èƒŒæ™¯&quot;">â€‹</a></h2><p>localStorage æ˜¯ Web Storage API æä¾›çš„ä¸€ç§å®¢æˆ·ç«¯å­˜å‚¨æœºåˆ¶ï¼Œä½†å®ƒå­˜åœ¨å­˜å‚¨å¤§å°é™åˆ¶ï¼ˆé€šå¸¸ä¸º5MBï¼‰ã€‚å½“æˆ‘ä»¬é‡åˆ°å­˜å‚¨æº¢å‡ºæ—¶ï¼Œéœ€è¦æœ‰åˆç†çš„è§£å†³æ–¹æ¡ˆã€‚</p><h2 id="localstorage-çš„æ ¸å¿ƒç‰¹æ€§-â­" tabindex="-1">localStorage çš„æ ¸å¿ƒç‰¹æ€§ â­ <a class="header-anchor" href="#localstorage-çš„æ ¸å¿ƒç‰¹æ€§-â­" aria-label="Permalink to &quot;localStorage çš„æ ¸å¿ƒç‰¹æ€§ â­&quot;">â€‹</a></h2><ol><li><strong>æŒä¹…åŒ–å­˜å‚¨</strong>: æ•°æ®æ°¸ä¹…ä¿å­˜åœ¨æµè§ˆå™¨ä¸­ï¼Œé™¤éæ‰‹åŠ¨æ¸…é™¤</li><li><strong>è·¨é¡µé¢å…±äº«</strong>: åŒåŸŸåä¸‹çš„æ‰€æœ‰é¡µé¢å…±äº«åŒä¸€ä¸ª localStorage ç©ºé—´</li><li><strong>å­˜å‚¨é™åˆ¶</strong>: ä¸€èˆ¬ä¸º5MBï¼ˆä¸åŒæµè§ˆå™¨å¯èƒ½ç•¥æœ‰å·®å¼‚ï¼‰</li><li><strong>åŒæ­¥æ“ä½œ</strong>: è¯»å†™æ“ä½œéƒ½æ˜¯åŒæ­¥çš„ï¼Œå¯èƒ½å½±å“æ€§èƒ½</li></ol><h2 id="å­˜å‚¨æº¢å‡ºçš„å¸¸è§åŸå› -ğŸ¤”" tabindex="-1">å­˜å‚¨æº¢å‡ºçš„å¸¸è§åŸå›  ğŸ¤” <a class="header-anchor" href="#å­˜å‚¨æº¢å‡ºçš„å¸¸è§åŸå› -ğŸ¤”" aria-label="Permalink to &quot;å­˜å‚¨æº¢å‡ºçš„å¸¸è§åŸå›  ğŸ¤”&quot;">â€‹</a></h2><ol><li>åŒåŸŸåä¸‹å¤šä¸ªä¸šåŠ¡çº¿äº’ç›¸äº‰æŠ¢å­˜å‚¨ç©ºé—´</li><li>å­˜å‚¨äº†ä¸é€‚åˆæ”¾åœ¨ localStorage ä¸­çš„å¤§å‹æ•°æ®</li><li>å†å²æ•°æ®æœªåŠæ—¶æ¸…ç†</li><li>æ•°æ®æœªåšå‹ç¼©å¤„ç†</li></ol><h2 id="è§£å†³æ–¹æ¡ˆ-ğŸ’¡" tabindex="-1">è§£å†³æ–¹æ¡ˆ ğŸ’¡ <a class="header-anchor" href="#è§£å†³æ–¹æ¡ˆ-ğŸ’¡" aria-label="Permalink to &quot;è§£å†³æ–¹æ¡ˆ ğŸ’¡&quot;">â€‹</a></h2><h3 id="_1-æ¶æ„å±‚é¢çš„ä¼˜åŒ–" tabindex="-1">1. æ¶æ„å±‚é¢çš„ä¼˜åŒ– <a class="header-anchor" href="#_1-æ¶æ„å±‚é¢çš„ä¼˜åŒ–" aria-label="Permalink to &quot;1. æ¶æ„å±‚é¢çš„ä¼˜åŒ–&quot;">â€‹</a></h3><ul><li><p>ğŸ”¸ <strong>åŸŸååˆ’åˆ†</strong></p><ul><li>ä¸ºä¸åŒä¸šåŠ¡çº¿é…ç½®ç‹¬ç«‹åŸŸå</li><li>æ¯ä¸ªä¸šåŠ¡åŸŸåç‹¬ç«‹ç®¡ç†è‡ªå·±çš„å­˜å‚¨ç©ºé—´</li></ul></li><li><p>ğŸ”¸ <strong>ç»Ÿä¸€å­˜å‚¨ç®¡ç†</strong></p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> StorageManager</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  static</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> maxSize</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1024</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1024</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// é¢„ç•™1MBé˜²æ­¢æº¢å‡º</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  static</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(value)]).size;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.maxSize) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;æ•°æ®è¶…å‡ºå­˜å‚¨é™åˆ¶&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    localStorage.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(key, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(value));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ul><h3 id="_2-æŠ€æœ¯æ–¹æ¡ˆä¼˜åŒ–" tabindex="-1">2. æŠ€æœ¯æ–¹æ¡ˆä¼˜åŒ– <a class="header-anchor" href="#_2-æŠ€æœ¯æ–¹æ¡ˆä¼˜åŒ–" aria-label="Permalink to &quot;2. æŠ€æœ¯æ–¹æ¡ˆä¼˜åŒ–&quot;">â€‹</a></h3><ul><li><p>ğŸ”¸ <strong>ä½¿ç”¨æ›¿ä»£å­˜å‚¨æ–¹æ¡ˆ</strong></p><ul><li>IndexedDB: é€‚åˆå­˜å‚¨å¤§æ–‡ä»¶å’ŒäºŒè¿›åˆ¶æ•°æ®</li><li>WebSQL: é€‚åˆç»“æ„åŒ–æ•°æ®ï¼ˆå·²åºŸå¼ƒï¼Œä¸æ¨èï¼‰</li><li>SessionStorage: ä¸´æ—¶å­˜å‚¨æ–¹æ¡ˆ</li></ul></li><li><p>ğŸ”¸ <strong>æ•°æ®å‹ç¼©</strong></p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { compress, decompress } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;lz-string&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å‹ç¼©å­˜å‚¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">localStorage.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;data&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">compress</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(bigData)));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è§£å‹è¯»å–</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">decompress</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(localStorage.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;data&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)));</span></span></code></pre></div></li></ul><h3 id="_3-æ•°æ®ä¼˜åŒ–" tabindex="-1">3. æ•°æ®ä¼˜åŒ– <a class="header-anchor" href="#_3-æ•°æ®ä¼˜åŒ–" aria-label="Permalink to &quot;3. æ•°æ®ä¼˜åŒ–&quot;">â€‹</a></h3><ul><li><p>ğŸ”¸ <strong>å®šæœŸæ¸…ç†</strong></p><ul><li>è®¾ç½®æ•°æ®è¿‡æœŸæ—¶é—´</li><li>å®ç° LRU ç¼“å­˜ç­–ç•¥</li></ul></li><li><p>ğŸ”¸ <strong>æ•°æ®åˆ†ç‰‡</strong></p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> chunk</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1024</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1024</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> chunks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> stringData</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> stringData.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> size) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    chunks.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(stringData.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">slice</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(i, i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> size));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> chunks;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div></li></ul><h2 id="æœ€ä½³å®è·µå»ºè®®-ğŸ“" tabindex="-1">æœ€ä½³å®è·µå»ºè®® ğŸ“ <a class="header-anchor" href="#æœ€ä½³å®è·µå»ºè®®-ğŸ“" aria-label="Permalink to &quot;æœ€ä½³å®è·µå»ºè®® ğŸ“&quot;">â€‹</a></h2><ol><li><p><strong>åˆç†è¯„ä¼°å­˜å‚¨éœ€æ±‚</strong></p><ul><li>åœ¨å¼€å‘å‰è¯„ä¼°æ•°æ®é‡</li><li>é€‰æ‹©åˆé€‚çš„å­˜å‚¨æ–¹æ¡ˆ</li></ul></li><li><p><strong>å®ç°ç›‘æ§æœºåˆ¶</strong></p><ul><li>ç›‘æ§å­˜å‚¨ä½¿ç”¨é‡</li><li>è®¾ç½®é¢„è­¦é˜ˆå€¼</li></ul></li><li><p><strong>é™çº§å¤„ç†</strong></p><ul><li>å®ç°å­˜å‚¨å¤±è´¥çš„é™çº§æ–¹æ¡ˆ</li><li>è€ƒè™‘æœåŠ¡ç«¯å­˜å‚¨å¤‡é€‰æ–¹æ¡ˆ</li></ul></li></ol><h2 id="æ³¨æ„äº‹é¡¹-âš ï¸" tabindex="-1">æ³¨æ„äº‹é¡¹ âš ï¸ <a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-âš ï¸" aria-label="Permalink to &quot;æ³¨æ„äº‹é¡¹ âš ï¸&quot;">â€‹</a></h2><ol><li>é¿å…å­˜å‚¨æ•æ„Ÿä¿¡æ¯</li><li>æ³¨æ„æµè§ˆå™¨å…¼å®¹æ€§</li><li>å®ç°é”™è¯¯å¤„ç†æœºåˆ¶</li><li>å®šæœŸæ¸…ç†æ— ç”¨æ•°æ®</li><li>è€ƒè™‘ç§»åŠ¨ç«¯çš„å­˜å‚¨é™åˆ¶</li></ol>`,18),t=[h];function k(p,e,r,E,g,d){return a(),i("div",null,t)}const c=s(n,[["render",k]]);export{y as __pageData,c as default};
