import{_ as s,c as i,o as a,a5 as n}from"./chunks/framework.Bx-mEslM.js";const c=JSON.parse('{"title":"æ·±å…¥ç†è§£ Token è®¤è¯ä¸æ— æ„Ÿåˆ·æ–°æœºåˆ¶ ğŸ”","description":"","frontmatter":{"title":"æ·±å…¥ç†è§£ Token è®¤è¯ä¸æ— æ„Ÿåˆ·æ–°æœºåˆ¶ ğŸ”","date":"2023-8-26","categories":["javascript","é¢è¯•","å·¥ä½œéšè®°"]},"headers":[],"relativePath":"blogs/word/2023/0826.md","filePath":"blogs/word/2023/0826.md"}'),l={name:"blogs/word/2023/0826.md"},h=n(`<h1 id="æ·±å…¥ç†è§£-token-è®¤è¯ä¸æ— æ„Ÿåˆ·æ–°æœºåˆ¶" tabindex="-1">æ·±å…¥ç†è§£ Token è®¤è¯ä¸æ— æ„Ÿåˆ·æ–°æœºåˆ¶ <a class="header-anchor" href="#æ·±å…¥ç†è§£-token-è®¤è¯ä¸æ— æ„Ÿåˆ·æ–°æœºåˆ¶" aria-label="Permalink to &quot;æ·±å…¥ç†è§£ Token è®¤è¯ä¸æ— æ„Ÿåˆ·æ–°æœºåˆ¶&quot;">â€‹</a></h1><h2 id="ä»€ä¹ˆæ˜¯åŒ-token-æœºåˆ¶-ğŸ¤”" tabindex="-1">ä»€ä¹ˆæ˜¯åŒ Token æœºåˆ¶ï¼ŸğŸ¤” <a class="header-anchor" href="#ä»€ä¹ˆæ˜¯åŒ-token-æœºåˆ¶-ğŸ¤”" aria-label="Permalink to &quot;ä»€ä¹ˆæ˜¯åŒ Token æœºåˆ¶ï¼ŸğŸ¤”&quot;">â€‹</a></h2><p>åœ¨ç°ä»£ Web åº”ç”¨ä¸­ï¼ŒToken è®¤è¯æœºåˆ¶æ‰®æ¼”ç€è‡³å…³é‡è¦çš„è§’è‰²ã€‚ä½†ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦ä½¿ç”¨åŒ Token æœºåˆ¶å‘¢ï¼Ÿ</p><h3 id="access-token-å’Œ-refresh-token-çš„åŒºåˆ«" tabindex="-1">Access Token å’Œ Refresh Token çš„åŒºåˆ« <a class="header-anchor" href="#access-token-å’Œ-refresh-token-çš„åŒºåˆ«" aria-label="Permalink to &quot;Access Token å’Œ Refresh Token çš„åŒºåˆ«&quot;">â€‹</a></h3><ul><li><p><strong>Access Token</strong> ğŸ«</p><ul><li>ç”¨äºè®¿é—®å—ä¿æŠ¤çš„èµ„æº</li><li>æœ‰æ•ˆæœŸè¾ƒçŸ­ï¼ˆé€šå¸¸å‡ å°æ—¶æˆ–æ›´çŸ­ï¼‰</li><li>é¢‘ç¹ä½¿ç”¨</li><li>å®‰å…¨è¦æ±‚é«˜</li></ul></li><li><p><strong>Refresh Token</strong> ğŸ”„</p><ul><li>ç”¨äºè·å–æ–°çš„ Access Token</li><li>æœ‰æ•ˆæœŸè¾ƒé•¿ï¼ˆé€šå¸¸å‡ å¤©åˆ°å‡ å‘¨ï¼‰</li><li>ä½¿ç”¨é¢‘ç‡ä½</li><li>åªç”¨äºåˆ·æ–°ï¼Œä¸èƒ½ç›´æ¥è®¿é—®èµ„æº</li></ul></li></ul><h3 id="è®¤è¯æµç¨‹-ğŸ“" tabindex="-1">è®¤è¯æµç¨‹ ğŸ“ <a class="header-anchor" href="#è®¤è¯æµç¨‹-ğŸ“" aria-label="Permalink to &quot;è®¤è¯æµç¨‹ ğŸ“&quot;">â€‹</a></h3><ol><li>ç”¨æˆ·ç™»å½• â†’ æœåŠ¡å™¨è¿”å› Access Token å’Œ Refresh Token</li><li>ä½¿ç”¨ Access Token è¯·æ±‚èµ„æº</li><li>Access Token è¿‡æœŸ â†’ æœåŠ¡å™¨è¿”å›è¿‡æœŸé”™è¯¯</li><li>ä½¿ç”¨ Refresh Token è·å–æ–°çš„ Access Token</li><li>ä½¿ç”¨æ–°çš„ Access Token ç»§ç»­è®¿é—®èµ„æº</li></ol><h2 id="æ— æ„Ÿåˆ·æ–°å®ç°æ–¹æ¡ˆ-âš™ï¸" tabindex="-1">æ— æ„Ÿåˆ·æ–°å®ç°æ–¹æ¡ˆ âš™ï¸ <a class="header-anchor" href="#æ— æ„Ÿåˆ·æ–°å®ç°æ–¹æ¡ˆ-âš™ï¸" aria-label="Permalink to &quot;æ— æ„Ÿåˆ·æ–°å®ç°æ–¹æ¡ˆ âš™ï¸&quot;">â€‹</a></h2><h3 id="æ–¹æ¡ˆä¸€-è¯·æ±‚å‰æ‹¦æˆª" tabindex="-1">æ–¹æ¡ˆä¸€ï¼šè¯·æ±‚å‰æ‹¦æˆª <a class="header-anchor" href="#æ–¹æ¡ˆä¸€-è¯·æ±‚å‰æ‹¦æˆª" aria-label="Permalink to &quot;æ–¹æ¡ˆä¸€ï¼šè¯·æ±‚å‰æ‹¦æˆª&quot;">â€‹</a></h3><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è¯·æ±‚å‰åˆ¤æ–­ token æ˜¯å¦è¿‡æœŸ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isTokenExpired</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> refreshToken</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç»§ç»­å‘èµ·åŸè¯·æ±‚</span></span></code></pre></div><p><strong>ä¼˜ç‚¹</strong> âœ…</p><ul><li>å¯ä»¥å‡å°‘æ— æ•ˆè¯·æ±‚</li><li>æé«˜æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ</li></ul><p><strong>ç¼ºç‚¹</strong> âŒ</p><ul><li>éœ€è¦åç«¯æä¾› token è¿‡æœŸæ—¶é—´</li><li>ä¾èµ–å®¢æˆ·ç«¯æ—¶é—´ï¼Œå¯èƒ½å­˜åœ¨å®‰å…¨éšæ‚£</li></ul><h3 id="æ–¹æ¡ˆäºŒ-å“åº”åæ‹¦æˆª" tabindex="-1">æ–¹æ¡ˆäºŒï¼šå“åº”åæ‹¦æˆª <a class="header-anchor" href="#æ–¹æ¡ˆäºŒ-å“åº”åæ‹¦æˆª" aria-label="Permalink to &quot;æ–¹æ¡ˆäºŒï¼šå“åº”åæ‹¦æˆª&quot;">â€‹</a></h3><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å“åº”æ‹¦æˆªå™¨ä¸­å¤„ç†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (response.code </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> TOKEN_EXPIRED</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> refreshToken</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> retry</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(originalRequest);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>ä¼˜ç‚¹</strong> âœ…</p><ul><li>å®ç°ç®€å•</li><li>ä¸ä¾èµ–å®¢æˆ·ç«¯æ—¶é—´</li><li>æ›´å¯é </li></ul><p><strong>ç¼ºç‚¹</strong> âŒ</p><ul><li>ä¼šäº§ç”Ÿé¢å¤–çš„è¯·æ±‚å¼€é”€</li></ul><h2 id="æœ€ä½³å®è·µç¤ºä¾‹-ğŸ’¡" tabindex="-1">æœ€ä½³å®è·µç¤ºä¾‹ ğŸ’¡ <a class="header-anchor" href="#æœ€ä½³å®è·µç¤ºä¾‹-ğŸ’¡" aria-label="Permalink to &quot;æœ€ä½³å®è·µç¤ºä¾‹ ğŸ’¡&quot;">â€‹</a></h2><h3 id="_1-é…ç½®å¸¸é‡" tabindex="-1">1. é…ç½®å¸¸é‡ <a class="header-anchor" href="#_1-é…ç½®å¸¸é‡" aria-label="Permalink to &quot;1. é…ç½®å¸¸é‡&quot;">â€‹</a></h3><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// constants.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> TOKEN_CONFIG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ACCESS_TOKEN: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;access_token&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  REFRESH_TOKEN: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;refresh_token&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  TOKEN_HEADER: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Authorization&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  REFRESH_HEADER: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;X-Refresh-Token&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h3 id="_2-è¯·æ±‚æ‹¦æˆªå™¨å®ç°" tabindex="-1">2. è¯·æ±‚æ‹¦æˆªå™¨å®ç° <a class="header-anchor" href="#_2-è¯·æ±‚æ‹¦æˆªå™¨å®ç°" aria-label="Permalink to &quot;2. è¯·æ±‚æ‹¦æˆªå™¨å®ç°&quot;">â€‹</a></h3><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// axios é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> service</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> axios.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">create</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  timeout: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  baseURL: process.env.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">API_BASE_URL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è¯·æ±‚é˜Ÿåˆ—ç®¡ç†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> refreshing </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> waitQueue</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">service.interceptors.response.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  response</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  async</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> error</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> error;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (response?.status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 401</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;&amp;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> !</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">config._retry) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (refreshing) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // å°†è¯·æ±‚åŠ å…¥ç­‰å¾…é˜Ÿåˆ—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">resolve</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          waitQueue.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">service</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(config)));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      refreshing </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      config._retry </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> newToken</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> refreshAccessToken</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // æ›´æ–° token åé‡è¯•æ‰€æœ‰ç­‰å¾…çš„è¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        waitQueue.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cb</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        waitQueue.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> service</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(config);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (err) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // åˆ·æ–°å¤±è´¥ï¼Œè·³è½¬ç™»å½•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        router.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/login&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">reject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">finally</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        refreshing </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">reject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(error);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h2 id="æ³¨æ„äº‹é¡¹-âš ï¸" tabindex="-1">æ³¨æ„äº‹é¡¹ âš ï¸ <a class="header-anchor" href="#æ³¨æ„äº‹é¡¹-âš ï¸" aria-label="Permalink to &quot;æ³¨æ„äº‹é¡¹ âš ï¸&quot;">â€‹</a></h2><ol><li><p><strong>å®‰å…¨æ€§è€ƒè™‘</strong></p><ul><li>Refresh Token åº”å¦¥å–„ä¿å­˜</li><li>å»ºè®®ä½¿ç”¨ HttpOnly Cookie å­˜å‚¨</li><li>è€ƒè™‘ä½¿ç”¨ HTTPS ä¼ è¾“</li></ul></li><li><p><strong>å¹¶å‘è¯·æ±‚å¤„ç†</strong></p><ul><li>å¤šä¸ªè¯·æ±‚åŒæ—¶å¤±æ•ˆæ—¶è¦é¿å…é‡å¤åˆ·æ–°</li><li>ä½¿ç”¨è¯·æ±‚é˜Ÿåˆ—ç®¡ç†å¹¶å‘</li></ul></li><li><p><strong>å¼‚å¸¸å¤„ç†</strong></p><ul><li>åˆ·æ–°å¤±è´¥æ—¶è¦æœ‰åˆé€‚çš„é™çº§ç­–ç•¥</li><li>è€ƒè™‘ç½‘ç»œå¼‚å¸¸ã€æœåŠ¡å™¨å¼‚å¸¸ç­‰åœºæ™¯</li></ul></li><li><p><strong>ç”¨æˆ·ä½“éªŒ</strong></p><ul><li>åˆ·æ–°è¿‡ç¨‹å¯¹ç”¨æˆ·åº”è¯¥æ˜¯æ— æ„ŸçŸ¥çš„</li><li>å¯ä»¥æ·»åŠ é€‚å½“çš„åŠ è½½æç¤º</li></ul></li></ol><h2 id="å‚è€ƒèµ„æ–™-ğŸ“š" tabindex="-1">å‚è€ƒèµ„æ–™ ğŸ“š <a class="header-anchor" href="#å‚è€ƒèµ„æ–™-ğŸ“š" aria-label="Permalink to &quot;å‚è€ƒèµ„æ–™ ğŸ“š&quot;">â€‹</a></h2><ul><li><a href="https://tools.ietf.org/html/rfc6749" target="_blank" rel="noreferrer">OAuth 2.0 RFC6749</a></li><li><a href="https://auth0.com/blog/refresh-tokens-what-are-they-and-when-to-use-them/" target="_blank" rel="noreferrer">JWT æœ€ä½³å®è·µ</a></li></ul>`,29),k=[h];function t(e,p,r,E,d,g){return a(),i("div",null,k)}const y=s(l,[["render",t]]);export{c as __pageData,y as default};
