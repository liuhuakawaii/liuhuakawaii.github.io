import{_ as s,c as i,o as a,a5 as n}from"./chunks/framework.BIhQMg0k.js";const o=JSON.parse('{"title":"å¦‚ä½•ä¸­æ–­å‰ç«¯ç½‘ç»œè¯·æ±‚ï¼Ÿ","description":"","frontmatter":{"title":"å¦‚ä½•ä¸­æ–­å‰ç«¯ç½‘ç»œè¯·æ±‚ï¼Ÿ","date":"2022-6-05","categories":["javascript","é¢è¯•"]},"headers":[],"relativePath":"blogs/javascript/jstips/20220605.md","filePath":"blogs/javascript/jstips/20220605.md"}'),l={name:"blogs/javascript/jstips/20220605.md"},h=n(`<h1 id="å¦‚ä½•ä¸­æ–­å‰ç«¯ç½‘ç»œè¯·æ±‚-ğŸš€" tabindex="-1">å¦‚ä½•ä¸­æ–­å‰ç«¯ç½‘ç»œè¯·æ±‚ï¼ŸğŸš€ <a class="header-anchor" href="#å¦‚ä½•ä¸­æ–­å‰ç«¯ç½‘ç»œè¯·æ±‚-ğŸš€" aria-label="Permalink to &quot;å¦‚ä½•ä¸­æ–­å‰ç«¯ç½‘ç»œè¯·æ±‚ï¼ŸğŸš€&quot;">â€‹</a></h1><h2 id="_1-åº”ç”¨åœºæ™¯-ğŸ’¡" tabindex="-1">1. åº”ç”¨åœºæ™¯ ğŸ’¡ <a class="header-anchor" href="#_1-åº”ç”¨åœºæ™¯-ğŸ’¡" aria-label="Permalink to &quot;1. åº”ç”¨åœºæ™¯ ğŸ’¡&quot;">â€‹</a></h2><ul><li><p><strong>é‡å¤è¯·æ±‚å¤„ç†</strong> ğŸ”„</p><ul><li>åœºæ™¯ï¼šå¤šä¸ªç»„ä»¶åŒæ—¶è°ƒç”¨ç›¸åŒæ¥å£</li><li>è§£å†³ï¼šé¦–æ¬¡è¯·æ±‚è¿”å›åå–æ¶ˆå…¶ä»–è¯·æ±‚</li></ul></li><li><p><strong>ç«æ€é—®é¢˜å¤„ç†</strong> âš¡</p><ul><li>åœºæ™¯ï¼šå®šæ—¶è½®è¯¢æ—¶ï¼Œå‰ä¸€ä¸ªè¯·æ±‚å“åº”æ…¢äºåä¸€ä¸ªè¯·æ±‚</li><li>è§£å†³ï¼šå–æ¶ˆæ—§çš„æœªå®Œæˆè¯·æ±‚ï¼Œåªä¿ç•™æœ€æ–°è¯·æ±‚</li></ul></li><li><p><strong>è·¯ç”±åˆ‡æ¢è¯·æ±‚å¤„ç†</strong> ğŸ”€</p><ul><li>åœºæ™¯ï¼šSPAåº”ç”¨ä¸­ç»„ä»¶å¸è½½ä½†è¯·æ±‚ä»åœ¨è¿›è¡Œ</li><li>è§£å†³ï¼šç»„ä»¶å¸è½½æ—¶å–æ¶ˆæœªå®Œæˆçš„è¯·æ±‚</li></ul></li><li><p><strong>æ–‡ä»¶ä¸Šä¼ æ§åˆ¶</strong> ğŸ“¤</p><ul><li>åœºæ™¯ï¼šå¤§æ–‡ä»¶ä¸Šä¼ æ—¶éœ€è¦æš‚åœ/æ¢å¤åŠŸèƒ½</li><li>è§£å†³ï¼šé€šè¿‡è¯·æ±‚å–æ¶ˆå®ç°ä¸Šä¼ æ§åˆ¶</li></ul></li></ul><h2 id="_2-å®ç°æ–¹æ¡ˆ-ğŸ› ï¸" tabindex="-1">2. å®ç°æ–¹æ¡ˆ ğŸ› ï¸ <a class="header-anchor" href="#_2-å®ç°æ–¹æ¡ˆ-ğŸ› ï¸" aria-label="Permalink to &quot;2. å®ç°æ–¹æ¡ˆ ğŸ› ï¸&quot;">â€‹</a></h2><h3 id="_2-1-axios-å–æ¶ˆè¯·æ±‚" tabindex="-1">2.1 Axios å–æ¶ˆè¯·æ±‚ <a class="header-anchor" href="#_2-1-axios-å–æ¶ˆè¯·æ±‚" aria-label="Permalink to &quot;2.1 Axios å–æ¶ˆè¯·æ±‚&quot;">â€‹</a></h3><h4 id="æ–¹æ¡ˆä¸€-ä½¿ç”¨-canceltoken-source" tabindex="-1">æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ CancelToken.source() <a class="header-anchor" href="#æ–¹æ¡ˆä¸€-ä½¿ç”¨-canceltoken-source" aria-label="Permalink to &quot;æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ CancelToken.source()&quot;">â€‹</a></h4><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CancelToken</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> axios.CancelToken;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> source</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CancelToken.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">source</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å‘èµ·è¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">axios.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/api/data&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  cancelToken: source.token</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">err</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (axios.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isCancel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;è¯·æ±‚å·²å–æ¶ˆ:&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, err.message);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å–æ¶ˆè¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">source.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cancel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ç”¨æˆ·å–æ¶ˆäº†è¯·æ±‚&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h4 id="æ–¹æ¡ˆäºŒ-ä½¿ç”¨-canceltoken-constructor" tabindex="-1">æ–¹æ¡ˆäºŒï¼šä½¿ç”¨ CancelToken constructor <a class="header-anchor" href="#æ–¹æ¡ˆäºŒ-ä½¿ç”¨-canceltoken-constructor" aria-label="Permalink to &quot;æ–¹æ¡ˆäºŒï¼šä½¿ç”¨ CancelToken constructor&quot;">â€‹</a></h4><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CancelToken</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> axios.CancelToken;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cancel;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">axios.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/api/data&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  cancelToken: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CancelToken</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    cancel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> c;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å–æ¶ˆè¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cancel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ç”¨æˆ·å–æ¶ˆäº†è¯·æ±‚&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h3 id="_2-2-fetch-å–æ¶ˆè¯·æ±‚" tabindex="-1">2.2 Fetch å–æ¶ˆè¯·æ±‚ <a class="header-anchor" href="#_2-2-fetch-å–æ¶ˆè¯·æ±‚" aria-label="Permalink to &quot;2.2 Fetch å–æ¶ˆè¯·æ±‚&quot;">â€‹</a></h3><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> controller</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AbortController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> signal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> controller.signal;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/api/data&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { signal })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">response</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">json</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">err</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (err.name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;AbortError&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;è¯·æ±‚å·²å–æ¶ˆ&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å–æ¶ˆè¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">controller.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">abort</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span></code></pre></div><h2 id="_3-æœ€ä½³å®è·µ-â­" tabindex="-1">3. æœ€ä½³å®è·µ â­ <a class="header-anchor" href="#_3-æœ€ä½³å®è·µ-â­" aria-label="Permalink to &quot;3. æœ€ä½³å®è·µ â­&quot;">â€‹</a></h2><h3 id="_3-1-react-ç»„ä»¶ä¸­çš„ä½¿ç”¨ç¤ºä¾‹" tabindex="-1">3.1 React ç»„ä»¶ä¸­çš„ä½¿ç”¨ç¤ºä¾‹ <a class="header-anchor" href="#_3-1-react-ç»„ä»¶ä¸­çš„ä½¿ç”¨ç¤ºä¾‹" aria-label="Permalink to &quot;3.1 React ç»„ä»¶ä¸­çš„ä½¿ç”¨ç¤ºä¾‹&quot;">â€‹</a></h3><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DataComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> abortController</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useRef</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  useEffect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    abortController.current </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AbortController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(abortController.current.signal);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // ç»„ä»¶å¸è½½æ—¶å–æ¶ˆè¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      abortController.current?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">abort</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }, []);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="_3-2-é˜²æ­¢ç«æ€çš„è¯·æ±‚å°è£…" tabindex="-1">3.2 é˜²æ­¢ç«æ€çš„è¯·æ±‚å°è£… <a class="header-anchor" href="#_3-2-é˜²æ­¢ç«æ€çš„è¯·æ±‚å°è£…" aria-label="Permalink to &quot;3.2 é˜²æ­¢ç«æ€çš„è¯·æ±‚å°è£…&quot;">â€‹</a></h3><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> createCancelableRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> currentRequest </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // å–æ¶ˆä¹‹å‰çš„è¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (currentRequest) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      currentRequest.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">abort</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> controller</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AbortController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    currentRequest </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> controller;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> response</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(url, { signal: controller.signal });</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">json</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (error) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (error.name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;AbortError&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // å¤„ç†å–æ¶ˆè¯·æ±‚çš„æƒ…å†µ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      throw</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> error;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="_4-æ³¨æ„äº‹é¡¹-âš ï¸" tabindex="-1">4. æ³¨æ„äº‹é¡¹ âš ï¸ <a class="header-anchor" href="#_4-æ³¨æ„äº‹é¡¹-âš ï¸" aria-label="Permalink to &quot;4. æ³¨æ„äº‹é¡¹ âš ï¸&quot;">â€‹</a></h2><ol><li>Axios å–æ¶ˆè¯·æ±‚åï¼Œè¯·æ±‚çš„ Promise ä¼šè¢« rejectï¼Œéœ€è¦æ­£ç¡®å¤„ç†é”™è¯¯</li><li>åœ¨ç»„ä»¶å¸è½½æ—¶è¦ç¡®ä¿å–æ¶ˆæ‰€æœ‰æœªå®Œæˆçš„è¯·æ±‚ï¼Œé¿å…å†…å­˜æ³„æ¼</li><li>AbortController åœ¨ä½ç‰ˆæœ¬æµè§ˆå™¨å¯èƒ½ä¸æ”¯æŒï¼Œéœ€è¦è€ƒè™‘å…¼å®¹æ€§</li><li>å–æ¶ˆè¯·æ±‚ä¸ä¼šä¸­æ–­å·²ç»å‘é€åˆ°æœåŠ¡å™¨çš„è¯·æ±‚ï¼Œåªæ˜¯å–æ¶ˆäº†å¯¹å“åº”çš„å¤„ç†</li></ol><h2 id="_5-æµè§ˆå™¨å…¼å®¹æ€§-ğŸŒ" tabindex="-1">5. æµè§ˆå™¨å…¼å®¹æ€§ ğŸŒ <a class="header-anchor" href="#_5-æµè§ˆå™¨å…¼å®¹æ€§-ğŸŒ" aria-label="Permalink to &quot;5. æµè§ˆå™¨å…¼å®¹æ€§ ğŸŒ&quot;">â€‹</a></h2><ul><li><p>Fetch + AbortController:</p><ul><li>Chrome 66+</li><li>Firefox 57+</li><li>Safari 12.1+</li><li>Edge 16+</li></ul></li><li><p>XMLHttpRequest abort():</p><ul><li>æ‰€æœ‰ç°ä»£æµè§ˆå™¨éƒ½æ”¯æŒ</li></ul></li></ul><h2 id="_6-å‚è€ƒèµ„æ–™-ğŸ“š" tabindex="-1">6. å‚è€ƒèµ„æ–™ ğŸ“š <a class="header-anchor" href="#_6-å‚è€ƒèµ„æ–™-ğŸ“š" aria-label="Permalink to &quot;6. å‚è€ƒèµ„æ–™ ğŸ“š&quot;">â€‹</a></h2><ul><li><a href="https://axios-http.com/docs/cancellation" target="_blank" rel="noreferrer">Axios å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/AbortController" target="_blank" rel="noreferrer">MDN - AbortController</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Fetch_API" target="_blank" rel="noreferrer">MDN - Fetch API</a></li></ul>`,22),t=[h];function k(p,e,r,E,d,c){return a(),i("div",null,t)}const y=s(l,[["render",k]]);export{o as __pageData,y as default};
